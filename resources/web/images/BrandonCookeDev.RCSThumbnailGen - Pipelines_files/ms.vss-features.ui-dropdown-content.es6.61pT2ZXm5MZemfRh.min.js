"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Accessibility","VSS/Core/Util/String"],function(e,t,s,i,o,n){var l,r,a,d,c,p,h,u,m,b,x,f,I,g,v,w;l=t.ResourcesDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesDropdown.AnnounceFilterCleared="Filter selection cleared",t.ResourcesDropdown.AnnounceFilterResultCount="Showing {0} filtered items.",t.ResourcesDropdown.AnnounceFinishedLoadingItems="Finished loading items",t.ResourcesDropdown.AnnounceLoadingItems="Loading items",t.ResourcesDropdown.Close="Close",t.ResourcesDropdown.DropdownClearActionText="Clear",t.ResourcesDropdown.DropdownInitialLabel="Dropdown",t.ResourcesDropdown.Loading="Loading...",t.ResourcesDropdown.NoFilterResults="No items matched the supplied filter",t.ResourcesDropdown.NoItemsFound="No items found",t.ResourcesDropdown.Searching="Searching...",t.ResourcesDropdown.UseItem='Use "{0}"',function(e){r=t.ComponentsExpandableTextFieldExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0});let i=1;class o extends s.Component{constructor(e){super(e),this.textFieldElement=s.createRef(),this.expandable=s.createRef(),this.collapse=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.expand=(()=>{this.expandable.current&&this.expandable.current.expand()}),this.onBlur=(()=>{this.props.blurDismiss&&this.collapse(),this.props.onBlur&&this.props.onBlur()}),this.renderCallout=(()=>this.props.renderCallout(this,this.dropdownId,this.props.anchorElement?this.props.anchorElement:this.props.anchorPoint?void 0:this.containerElement.current?this.containerElement.current:void 0,this.props.anchorOffset||{horizontal:0,vertical:0},this.props.anchorOrigin||{horizontal:"end",vertical:"end"},this.props.anchorPoint,this.props.dropdownOrigin||{horizontal:"end",vertical:"start"})),this.dropdownId=e.dropdownId||"dropdown-"+i++,this.containerElement=e.containerRef||s.createRef()}render(){return s.createElement(t.Expandable.Expandable,{disabled:this.props.disabled,expandKey:this.props.expandKey,onCollapse:this.props.onCollapse,onExpand:this.props.onExpand,renderCallout:this.renderCallout,ref:this.expandable},e=>s.createElement("div",{className:t.Util.css(this.props.className,"bolt-expandable-textfield"),onMouseDown:e.onMouseDown,onKeyDown:e.onKeyDown,ref:this.containerElement},s.createElement(t.TextField.TextField,Object.assign({},this.props,{ariaControls:e.expanded?this.dropdownId:void 0,ariaExpanded:e.expanded,ariaHasPopup:!0,className:"",onBlur:this.onBlur,onClick:e.onClick,ref:this.textFieldElement,suffixIconProps:this.props.hideDropdownIcon?void 0:{key:"dropdown-icon",className:t.Util.css("bolt-expandable-textfield-icon icon-right",this.props.disabled&&"disabled"),iconName:"ChevronDown",onClick:e.onClick}}))))}focus(){this.textFieldElement.current&&this.textFieldElement.current.focus()}}o.defaultProps={expandKey:[40,13]},t.ComponentsExpandableTextFieldExpandableTextField.ExpandableTextField=o}(),a=t.ExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0}),t.ExpandableTextField.ExpandableTextField=r.ExpandableTextField,function(e){d=t.UtilitiesDropdownSelection={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesDropdownSelection.DropdownSelection=class extends t.List.ListSelection{constructor(){super({selectOnFocus:!1})}};t.UtilitiesDropdownSelection.DropdownMultiSelection=class extends t.List.ListSelection{constructor(){super({alwaysMerge:!0,multiSelect:!0,selectOnFocus:!1})}}}(),function(e){c=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].DefaultListBoxWidth=-100;class r extends s.Component{constructor(e){super(e),this.tabbableIndex=-1,this.positions=[],this.count=0,this.table=s.createRef(),this.getItemWidth=(()=>{const{width:e}=this.props;return this.selection.multiSelect&&e&&e>0?e-t.Table.ColumnSelectWidth:e}),this.loadingChanged=(()=>(i.ObservableLike.getValue(this.props.loading)?o.announce(l.AnnounceLoadingItems):o.announce(l.AnnounceFinishedLoadingItems),!0)),this.searchingChanged=(()=>{if(i.ObservableLike.getValue(this.props.loading))o.announce(l.Searching);else{const e=this.props.items.length;o.announce(e>0?n.format(l.AnnounceFilterResultCount,e):l.NoFilterResults,!0)}return!0}),this.onItemsChanged=(()=>{const e=m(this.wrappedItems||this.props.items);this.tabbableIndex=-1,this.positions=[],this.count=0;for(const t of e){const e=i.ObservableLike.getValue(t);e&&!h(e)?this.positions.push(-1):(-1===this.tabbableIndex&&this.selection.selectable(this.positions.length)&&(this.tabbableIndex=this.positions.length),this.positions.push(++this.count))}return!0}),this.onActivate=((e,t)=>{this.props.onActivate&&this.props.onActivate(e,t.data)}),this.onSelect=((e,t)=>{this.props.onSelect&&this.props.onSelect(e,t.data)}),this.renderListBoxRow=((e,i,o)=>{const{excludeFocusZone:n,excludeTabStop:l}=this.props,r=!n&&this.selection.selectable(e),a=Object.assign({},o,{ariaPosInSet:this.positions[e]>=0?this.positions[e]:null,ariaSetSize:this.positions[e]>=0?this.count:null,excludeTabStop:l||this.tabbableIndex!==e,excludeFocusZone:!r,singleClickActivation:!1,role:2===i.type||3===i.type?"row":this.selection.multiSelect?"menuitemcheckbox":"option"});return s.createElement(t.Observer.Observer,{key:e,item:i},()=>s.createElement(t.Table.TableRow,{key:e,index:e,details:a,className:t.Util.css(2===i.type&&"bolt-list-box-header-row",3===i.type&&"bolt-list-box-divider-row",4===i.type&&"bolt-list-box-loading-row",this.selection.multiSelect&&"bolt-list-box-multi-select-row",2!==i.type&&3!==i.type&&"cursor-pointer")},this.columns.map((s,o)=>this.selection.multiSelect&&0===o&&!r?3===i.type||4===i.type?null:t.Table.renderEmptyCell(e,o):s.renderCell(e,o,s,i))))}),this.renderListBoxCell=((e,t,s,i)=>a(e,t,s,i,this.selection.multiSelect));const{selection:r,renderItem:c,items:p}=this.props;this.selection=r||new d.DropdownSelection,this.columns=this.selection.multiSelect?[new t.Table.ColumnSelect]:[],this.columns.push({id:"text",width:this.getItemWidth(),renderCell:c||this.renderListBoxCell,className:t.Util.css("bolt-list-box-text",this.selection.multiSelect?"bolt-list-box-text-multi-select":"bolt-list-box-text-single-select")}),this.wrappedItems=u(p),this.onItemsChanged()}componentDidUpdate(){this.props.didUpdate&&this.props.didUpdate()}render(){const{className:e,containerClassName:i,focuszoneProps:o,getUnselectableRanges:n,items:r,loading:a,searching:d,width:c}=this.props,p={observableValue:r,filter:this.onItemsChanged},h=this.wrappedItems?new t.UtilitiesProvider.ArrayItemProvider(this.wrappedItems):Array.isArray(r)?new t.UtilitiesProvider.ArrayItemProvider(r):r;return this.columns[this.columns.length-1].width=this.getItemWidth(),s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:n,items:r,selection:this.selection},s.createElement(t.Observer.Observer,{items:p,loading:{observableValue:a||!1,filter:this.loadingChanged},searching:{observableValue:d||!1,filter:this.searchingChanged}},n=>n.searching?s.createElement("div",{className:"bolt-list-box-loading",style:{width:c}},s.createElement(t.Spinner.Spinner,{size:"medium",label:l.Searching})):s.createElement(t.Table.Table,{className:t.Util.css(e,"bolt-list-box"),columns:this.columns,containerClassName:i,focuszoneProps:o,itemProvider:h,onActivate:this.onActivate,onSelect:this.onSelect,renderRow:this.renderListBoxRow,ref:this.table,role:this.selection.multiSelect?"menu":"listbox",scrollable:!0,singleClickActivation:!1,selection:this.selection,showHeader:!1,showLines:!1,spacerWidth:0})))}scrollIntoView(e,t){if(this.table.current)return this.table.current.scrollIntoView(e,t)}}function a(e,i,o,n,l){return n.render?n.render(e,i,o,n):3===n.type?s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(o.className,n.className,l&&"bolt-list-box-divider-multi-select"),columnIndex:i,colspan:l?2:1,key:i,tableColumn:o},s.createElement("div",{className:"bolt-list-box-divider flex-grow"})):4===n.type?s.createElement(b,{columnIndex:i,key:i,tableColumn:o,tableItem:n}):s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(o.className,n.className,2===n.type&&"bolt-list-box-header"),columnIndex:i,key:i,tableColumn:o},n&&t.List.renderListCell(n))}function p(e,t=h){const s=[];let i=-1;for(let o=0;o<e.length;o++)!t(e[o])&&i<0?i=o:t(e[o])&&i>=0&&(s.push({beginIndex:i,endIndex:o-1}),i=-1);return i>=0&&s.push({beginIndex:i,endIndex:e.length-1}),s}function h(e){return 2!==e.type&&3!==e.type&&4!==e.type}function u(e){if(Array.isArray(e)&&e.length&&"string"==typeof e[0])return e.map(e=>({id:e,text:e}))}function m(e){return t.UtilitiesProvider.getItemsValue(e)}r.defaultProps={getUnselectableRanges:p,width:t[e].DefaultListBoxWidth},t[e].ListBox=r,t[e].renderListBoxCell=a,t[e].getUnselectableRanges=p,t[e].listBoxItemSelectable=h,t[e].wrapListBoxItems=u,t[e].getListBoxItemsValue=m;class b extends s.Component{componentDidMount(){this.props.onMount&&this.props.onMount()}render(){const{columnIndex:e,tableColumn:i,tableItem:o}=this.props;return s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(i.className,o.className),columnIndex:e,colspan:2,contentClassName:"justify-center",key:e,tableColumn:i},s.createElement("div",{className:"bolt-list-box-loading"},s.createElement(t.Spinner.Spinner,{size:"medium",label:l.Loading})))}}t[e].LoadingCell=b}("ComponentsListBoxListBox"),p=t.ListBox={},Object.defineProperty(t,"__esModule",{value:!0}),t.ListBox.DefaultListBoxWidth=c.DefaultListBoxWidth,t.ListBox.getListBoxItemsValue=c.getListBoxItemsValue,t.ListBox.getUnselectableRanges=c.getUnselectableRanges,t.ListBox.ListBox=c.ListBox,t.ListBox.listBoxItemSelectable=c.listBoxItemSelectable,t.ListBox.LoadingCell=c.LoadingCell,t.ListBox.renderListBoxCell=c.renderListBoxCell,t.ListBox.wrapListBoxItems=c.wrapListBoxItems,function(e){h=t.ComponentsDropdownDropdownCallout={},Object.defineProperty(t,"__esModule",{value:!0});const o=10,r=256;t.ComponentsDropdownDropdownCallout.DropdownCallout=function(e){return s.createElement(a,Object.assign({},e))};class a extends s.Component{constructor(e){super(e),this.calloutContent=s.createRef(),this.listBoxDidUpdate=(()=>{this.getScrollWidth()}),this.getScrollWidth=(()=>{window.requestAnimationFrame(()=>{if(this.calloutContent.current){const e=this.calloutContent.current.offsetWidth-this.props.width;Math.abs(e)>1&&this.setState({scrollBarWidth:e+this.state.scrollBarWidth})}})}),this.state={scrollBarWidth:0}}componentDidMount(){this.getScrollWidth()}render(){const{actions:e,anchorElement:a,anchorOffset:d,anchorOrigin:c,anchorPoint:h,calloutContentClassName:u,containerClassName:m,dropdownOrigin:b,excludeFocusZone:x,excludeTabStop:f,filteredItems:I,filteredNoResultsText:g,filterPlaceholderText:v,filterText:w,focusOnMount:C,getUnselectableRanges:E,id:D,ignoreMouseDown:F,items:S,lightDismiss:O,listBoxClassName:B,listBoxRef:y,loading:P,onActivate:L,onFilterTextChanged:T,onSelect:N,renderBeforeContent:R,renderItem:U,searching:V,selection:M,showCloseButton:k,showFilterBox:A,title:_,updateFilteredItems:j,userFilteredItems:W}=this.props;let{width:G=r}=this.props;G>0&&(G-=this.state.scrollBarWidth);const z=`bolt-dropdown-textfield-${D}`,K=()=>{this.props.onDismiss&&this.props.onDismiss(),w.value="",T&&T(null,""),j()};return s.createElement(t.Callout.Callout,{anchorElement:a,anchorOffset:d,anchorOrigin:c,anchorPoint:h,blurDismiss:!0,calloutOrigin:b,contentClassName:t.Util.css(u,"bolt-dropdown flex-column custom-scrollbar v-scroll-auto h-scroll-hidden"),contentRef:this.calloutContent,contentShadow:!0,contentSize:3,escDismiss:!0,id:D,lightDismiss:O,focuszoneProps:{postprocessKeyStroke:e=>9!==e.which||e.defaultPrevented?1:(e.preventDefault(),K(),3)},onDismiss:K},s.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:A?`#${t.Util.getSafeId(z)}`:".bolt-dropdown-init-focus",direction:2,focusOnMount:void 0===C||C},s.createElement("div",{className:"bolt-dropdown-container",onMouseDown:F?t.Util.preventDefault:void 0},s.createElement("div",{"aria-hidden":"true","aria-label":l.DropdownInitialLabel,"aria-roledescription":"dialog",className:"bolt-dropdown-init-focus no-outline",tabIndex:f?void 0:-1,role:"menuitem"}),s.createElement(t.Observer.Observer,{items:S},()=>{const e=void 0===A?S.length>o:A;return e||_||k?s.createElement("div",{className:"bolt-dropdown-header-container"},(_||k)&&s.createElement("div",{className:"bolt-dropdown-header flex-row flex-center"},s.createElement("div",{className:"bolt-dropdown-header-text flex-grow"},_),k&&s.createElement(t.Button.Button,{ariaLabel:l.Close,iconProps:{iconName:"Cancel"},onClick:K,subtle:!0})),e&&s.createElement("div",{key:"bolt-dropdown-filter-container",className:"bolt-dropdown-filter-container",style:{width:G}},s.createElement(t.TextField.TextField,{key:"bolt-dropdown-filter",className:"bolt-dropdown-filter",excludeTabStop:!0,inputId:z,onChange:T,placeholder:v,prefixIconProps:{iconName:"Search"},value:w}))):null}),R&&R(),s.createElement(t.Observer.Observer,{filteredItems:I,listBoxItems:{observableValue:S,filter:j},userFilteredItems:{observableValue:W,filter:j}},()=>{let e=null,i="";return 0!==I.length||V||(i=""===w.value?this.props.noItemsText:n.format(g||l.NoFilterResults,w.value),e=s.createElement("div",{className:"bolt-dropdown-no-items",style:{width:G}},i)),s.createElement(s.Fragment,null,e,s.createElement(p.ListBox,{className:B,containerClassName:t.Util.css("bolt-dropdown-list-box-container",m),didUpdate:this.listBoxDidUpdate,excludeFocusZone:x,excludeTabStop:!0,focuszoneProps:null,getUnselectableRanges:E,items:I.value,loading:P,onActivate:L,onSelect:N,renderItem:U,ref:y,searching:V,selection:M,width:G}))}),s.createElement(t.Observer.Observer,{actions:e},e=>{const o=this.props.actions;return o&&o.length?s.createElement("div",{className:"bolt-actions-container flex-column"},i.ObservableLike.getValue(o).map((e,i)=>s.createElement(t.Button.Button,Object.assign({key:e.id||i,subtle:!0,excludeTabStop:!0,role:"menuitem",ariaRoleDescription:e.role||"button"},e)))):null}))))}}a.defaultProps={width:r}}(),function(e){u=t.ComponentsDropdownDropdownExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownDropdownExpandableTextField.DropdownExpandableTextField=function(e){const{editable:i,expandableRef:o,items:n,inputClassName:l,onFocus:r,renderSelectedItems:d,selection:c}=e,p=__rest(e,["editable","expandableRef","items","inputClassName","onFocus","renderSelectedItems","selection"]);let h;return i||(h=e.placeholder,c.selectedCount>0&&(h=d(c,n))),s.createElement(a.ExpandableTextField,Object.assign({inputType:i?void 0:"button",ref:o,value:h,focusTreatment:i?0:1},p,{className:t.Util.css(e.className,"bolt-dropdown-expandable-text-field"),onFocus:i?e=>{o.current&&o.current.expand(),r&&r(e)}:r,inputClassName:t.Util.css(l,"bolt-dropdown-expandable-textfield-input text-ellipsis")}))}}(),function(e){m=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});class r extends s.Component{constructor(e){super(e),this.expandable=s.createRef(),this.expandableContainer=s.createRef(),this.filterText=new i.ObservableValue(""),this.collapse=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.expand=(()=>{this.expandable.current&&this.expandable.current.expand()}),this.onDismiss=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.onExpand=(()=>{this.props.onExpand&&this.props.onExpand(),this.updateFilteredItems()}),this.onActivate=((e,t)=>{e.defaultPrevented||"keydown"!==e.type||(this.state.filteredSelection.toggle(this.state.filteredItems.value.indexOf(t),this.state.filteredSelection.alwaysMerge),this.onSelect(e,t))}),this.onFilterTextChanged=((e,t)=>{this.filterText.value=t,this.updateFilteredItems()}),this.onSelect=((e,t)=>{const s=this.parentSelection;this.props.onSelect&&this.props.onSelect(e,t),s.value.length>0&&!s.multiSelect&&!s.selectOnFocus&&this.onDismiss()}),this.selectionChanged=((e,t)=>(this.state.filteredSelection.selectionChanged(e,t),!0)),this.renderCallout=((e,t,s,i,o,n,l)=>{const{actions:r,calloutContentClassName:a,containerClassName:d,filterPlaceholderText:c,filteredNoResultsText:p,getUnselectableRanges:h,items:u,loading:m,noItemsText:b,renderItem:x,searching:f,showFilterBox:I,userFilteredItems:g}=this.props;let v=this.props.width;void 0===v&&this.expandableContainer.current&&(v=this.expandableContainer.current.clientWidth);const{filteredItems:w,filterText:C,filteredSelection:E}=this.state,D={actions:r,anchorElement:s,anchorOffset:i,anchorOrigin:o,anchorPoint:n,calloutContentClassName:a,containerClassName:d,dropdownOrigin:l,filteredItems:w,filteredNoResultsText:p,selection:E,filterPlaceholderText:c,filterText:C,getUnselectableRanges:h,id:t,items:u,loading:m,noItemsText:b,onActivate:this.onActivate,onFilterTextChanged:this.onFilterTextChanged,onDismiss:this.onDismiss,onSelect:this.onSelect,renderItem:x,searching:f,showFilterBox:I,updateFilteredItems:this.updateFilteredItems,userFilteredItems:g,width:v};return this.props.renderCallout(D)}),this.updateFilteredItems=(()=>(b(this.props,this.state),!0)),this.parentSelection=e.selection||new d.DropdownSelection;const o=p.wrapListBoxItems(e.items),n=p.getListBoxItemsValue(o||e.items);this.state={filteredItems:new i.ObservableArray([...n]),filteredSelection:new t.List.FilteredListSelection(this.parentSelection),filterText:this.filterText,props:e,wrappedItems:o}}static getDerivedStateFromProps(e,t){return e.userFilteredItems===t.props.userFilteredItems&&e.items===t.props.items||b(e,t),Object.assign({},t,{props:e,wrappedItems:p.wrapListBoxItems(e.items)})}render(){const{ariaLabel:e,className:i,disabled:o,items:n,placeholder:l,onCollapse:r,renderExpandable:a}=this.props,d={observableValue:this.parentSelection,filter:this.selectionChanged};return s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:this.props.getUnselectableRanges,items:n,selection:this.parentSelection},s.createElement(t.Observer.Observer,{selection:d},()=>a({ariaLabel:e,className:t.Util.css(i,"bolt-dropdown-expandable"),containerRef:this.expandableContainer,disabled:o,placeholder:l,onCollapse:r,onExpand:this.onExpand,expandableRef:this.expandable,renderCallout:this.renderCallout,items:p.getListBoxItemsValue(this.state.wrappedItems||n),renderSelectedItems:c,selection:this.parentSelection})))}focus(){this.expandable.current&&this.expandable.current.focus()}}function a(e,t){return!(!t.text||2===t.type||3===t.type)&&-1!==t.text.toLowerCase().indexOf(e.toLowerCase())}function c(e,t){let s=t[e.value[0].beginIndex].text||"";return e.selectedCount>1&&(s=`${s} (+${e.selectedCount-1})`),s}function b(e,s){const{filteredSelection:i,filterText:r}=s;let a=[];const d=p.getListBoxItemsValue(s.wrappedItems||e.items);let c=d;if(e.userFilteredItems){c=t.UtilitiesProvider.getItemsValue(e.userFilteredItems);for(let t=0;t<e.userFilteredItems.length;t++){const e=d.indexOf(c[t]);0,a.push(e)}}if(e.filterByText&&r.value){const t=x(c,r.value,a,e.filterItem);c=t.filteredItems,a=t.filteredIndexMap}for(;c.length&&3===c[0].type;)c.shift(),a.shift();return r.value&&o.announce(c.length>0?n.format(l.AnnounceFilterResultCount,c.length):l.NoFilterResults,!0),s.filteredItems.value=c,i.updateFilteredSelection(a),!0}function x(e,t,s=[],i=a){const o=[],n=[];if(t){let l="";for(let r=e.length-1;r>=0;r--){if((2===e[r].type||3===e[r].type)&&e[r].groupId&&e[r].groupId===l){const t=s.length?s[r]:r;n.unshift(t),o.unshift(e[r])}if(i(t,e[r],e)){const t=s.length?s[r]:r;n.unshift(t),o.unshift(e[r]),l=e[r].groupId}}}return{filteredItems:o,filteredIndexMap:n}}r.defaultProps={filterByText:!0,filterItem:a,getUnselectableRanges:p.getUnselectableRanges,renderCallout:h.DropdownCallout,renderExpandable:u.DropdownExpandableTextField,renderSelectedItems:c},t[e].Dropdown=r,t[e].filterItemByText=a,t[e].renderDropdownSelectedItemText=c,t[e].filterItems=x}("ComponentsDropdownDropdown"),function(e){b=t.ComponentsDropdownDropdownExpandableButton={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownDropdownExpandableButton.DropdownExpandableButton=function(e){const{expandableRef:i,items:o,placeholder:n,renderSelectedItems:l,selection:r}=e,a=__rest(e,["expandableRef","items","placeholder","renderSelectedItems","selection"]);let d=n;return r.selectedCount>0&&(d=l(r,o)),s.createElement(t.Button.ExpandableButton,Object.assign({ref:i},a),s.createElement("div",{className:"bolt-dropdown-expandable-button-label justify-start flex-grow text-ellipsis"},d))}}(),function(e){x=t.ComponentsDropdownDropdownFilterBarItem={},Object.defineProperty(t,"__esModule",{value:!0});const n=256;t.ComponentsDropdownDropdownFilterBarItem.DropdownFilterBarItem=class extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.dropdown=s.createRef(),this.renderExpandableButton=(e=>{const{className:i,renderExpandable:o}=this.props,n=Object.assign({},e,{className:t.Util.css(i,"bolt-dropdown-filter-bar-item"),subtle:!0,renderSelectedItems:this.renderSelectedItems});return o?o(n):s.createElement(b.DropdownExpandableButton,Object.assign({},n))}),this.onClearClick=(()=>{this.selection.clear(),o.announce(l.AnnounceFilterCleared)}),this.onSelectionChanged=(e=>{const s=p.getListBoxItemsValue(this.wrappedItems||this.props.items),i=[];for(let t=0;t<e.length;t++)for(let o=e[t].beginIndex;o<=e[t].endIndex;o++)i.push(void 0!==s[o].data?s[o].data:s[o].id);if(this.props.filter){const e=this.props.filter.getFilterItemState(this.props.filterItemKey);let s=!1;(s=e?!t.Util.arrayEquals(e.value,i):!!i.length)&&this.setFilterValue({value:i})}return!0}),this.renderSelectedItems=((e,t)=>{let i=t[e.value[0].beginIndex].text||"";e.selectedCount>1&&(i=`${i} (+${e.selectedCount-1})`);const o=s.createElement("span",{className:"bolt-dropdown-filter-bar-item-selected-text"},i);return this.props.showPlaceholderAsLabel?s.createElement(s.Fragment,null,s.createElement("span",{className:"bolt-dropdown-filter-bar-item-placeholder"},`${this.props.placeholder}: `),o):o}),this.selection=e.selection||new d.DropdownSelection,this.wrappedItems=p.wrapListBoxItems(e.items)}focus(){this.dropdown.current&&this.dropdown.current.focus()}componentDidMount(){if(super.componentDidMount(),this.props.filter){const e=this.props.filter.getFilterItemState(this.props.filterItemKey);if(e&&e.value){const s=p.getListBoxItemsValue(this.wrappedItems||this.props.items),i=new t.List.ListSelection(this.selection.multiSelect);for(let t=0;t<e.value.length;t++){const o=s.findIndex(s=>s.id===e.value[t]||s.data===e.value[t]);i.select(o,1,!0)}this.selection.value=i.value}}}render(){return s.createElement(t.Observer.SelectionObserver,{selection:this.selection,onSelectionChanged:this.onSelectionChanged},()=>{const e=[...i.ObservableLike.getValue(this.props.actions||[])];return this.props.hideClearAction||e.push({className:"bolt-dropdown-action-right-button",disabled:0===this.selection.selectedCount,iconProps:{iconName:"Clear"},text:l.DropdownClearActionText,onClick:this.onClearClick}),s.createElement(m.Dropdown,Object.assign({renderExpandable:this.renderExpandableButton,width:n},this.props,{actions:e,selection:this.selection,ref:this.dropdown}))})}onFilterChanged(e){if(super.onFilterChanged(e),e&&e.value){const s=new t.List.ListSelection(this.selection.multiSelect),i=p.getListBoxItemsValue(this.wrappedItems||this.props.items);for(let t=0;t<e.value.length;t++){const o=i.findIndex(s=>s.id===e.value[t]||s.data===e.value[t]);s.select(o,1,!0)}t.UtilitiesSelection.compareSelectionRanges(this.selection.value,s.value).length&&(this.selection.value=s.value)}else this.selection.clear()}}}(),function(e){f=t.ComponentsDropdownWithPivots={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownWithPivots.WithPivots=function(e){const o=o=>s.createElement(h.DropdownCallout,Object.assign({},o,{renderBeforeContent:()=>(function(e){return s.createElement(t.FocusZone.FocusZoneContext.Consumer,null,o=>s.createElement(t.FocusZone.FocusZone,{direction:1},s.createElement("div",null,s.createElement(t.FocusWithin.FocusWithin,null,n=>e.pivots.map((l,r)=>s.createElement(t.Button.Button,{className:"bolt-dropdown-pivot",key:l.id,subtle:!0,onBlur:n.onBlur,onClick:()=>(function(e,t){t.onPivotClicked&&t.onPivotClicked(e)})(l,e),onFocus:n.onFocus,focusZoneId:0!==r||n.hasFocus?void 0:o.focuszoneId},s.createElement("span",{className:t.Util.css(e.selectedPivot&&l.id===i.ObservableLike.getValue(e.selectedPivot)&&"bolt-dropdown-pivot-selected")},l.name||l.id)))))))})(e)}));return s.createElement(t.Observer.Observer,{selectedPivot:e.selectedPivot},()=>{const t=function(e){let t;if(e.selectedPivot){const s=i.ObservableLike.getValue(e.selectedPivot);t=e.pivots.find(e=>e.id===s)}return t||e.pivots[0]}(e),s={actions:t.actions,filterByText:t.filterByText,userFilteredItems:t.items,filteredNoResultsText:t.filteredNoResultsText,filterPlaceholderText:t.filterPlaceholderText,noItemsText:t.noItemsText,renderCallout:o,showFilterBox:t.showFilterBox};return e.children(s)})}}(),I=t.Dropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown.Dropdown=m.Dropdown,t.Dropdown.filterItems=m.filterItems,t.Dropdown.DropdownCallout=h.DropdownCallout,t.Dropdown.DropdownExpandableButton=b.DropdownExpandableButton,t.Dropdown.DropdownExpandableTextField=u.DropdownExpandableTextField,t.Dropdown.DropdownFilterBarItem=x.DropdownFilterBarItem,t.Dropdown.WithPivots=f.WithPivots,function(e){g=t.UtilitiesEditableDropdownItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesEditableDropdownItemProvider.EditableDropdownItemProvider=class{constructor(e,t){this.itemCollection=new i.ObservableCollection,i.ObservableLike.isObservable(e)?this.listItems=e:this.listItems=new i.ObservableArray(p.wrapListBoxItems(e)||e),this.itemCollection.push(this.listItems),this.extraItem=new i.ObservableArray,this.itemCollection.push(this.extraItem),this.selection=t}get length(){return this.itemCollection.length}get value(){return this.itemCollection.value}get hasExtraItem(){return this.extraItem.length>0}subscribe(e,t){this.itemCollection.subscribe(e,t)}unsubscribe(e,t){return this.itemCollection.unsubscribe(e,t)}setTextValue(e){if(this.hasExtraItem&&this.extraItem.splice(0,1),e){const t=this.listItems.value.findIndex(t=>t.text===e);-1!==t&&this.selection.selectable(t)||this.extraItem.push({id:e,text:n.format(l.UseItem,e)})}}}}(),function(e){v=t.ComponentsEditableDropdownCustomEditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0});class o extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.listBox=s.createRef(),this.collapse=(()=>{this.dropdown.current&&this.dropdown.current.collapse()}),this.expand=(()=>{this.dropdown.current&&this.dropdown.current.expand()}),this.renderItem=((e,i,o,n)=>s.createElement(t.Observer.Observer,{focusedIndex:{observableValue:this.focusedIndex,filter:()=>{const t=this.filteredIndexMap[e];return t===this.focusedIndex.value||t===this.previousFocusedIndex}}},()=>{const s=this.filteredIndexMap[e]===this.focusedIndex.value?Object.assign({},n,{className:t.Util.css(n.className,"bolt-editable-dropdown-focused-item")}):n;return this.props.renderItem(e,i,o,s)})),this.onCollapse=(()=>{const{allowFreeform:e,onCollapse:t,onTextChange:s,onValueChange:o,text:n}=this.props;t&&t();const l=this.itemProvider.value.findIndex((e,t)=>this.selection.selectable(t)&&e.text===i.ObservableLike.getValue(n||""));l>-1&&this.selectIndex(l);const r=this.itemProvider.length-1;if(!e||this.selection.value.length&&this.selection.value[0].beginIndex!==r&&this.selectedItemInList||!this.itemProvider.hasExtraItem){if(this.selection.value.length){const e=this.itemProvider.value[this.selection.value[0].beginIndex];o&&o(e)}}else{const e=this.itemProvider.value[r].id;o&&o({id:e,text:e}),this.selection.clear()}s&&s(null,""),this.isExpanded=!1,this.selectedItemInList=!1}),this.onItemsChange=((e,t)=>{"change"!==t&&this.updateFilteredItems()}),this.onSelect=((e,t)=>{this.selectedItemInList=!0}),this.renderExpandable=(e=>{const{onTextChange:t,text:s}=this.props,i=Object.assign({},e,{editable:!0,blurDismiss:!0,onChange:t,onKeyDown:this.onKeyDown,value:s});return this.props.renderExpandable(i)}),this.renderCallout=(e=>{const t=Object.assign({},e,{focusOnMount:!1,excludeTabStop:!0,excludeFocusZone:!0,ignoreMouseDown:!0,listBoxRef:this.listBox});return this.props.renderCallout(t)}),this.onExpand=(()=>{this.props.onExpand&&this.props.onExpand(),this.filteredItems.splice(0,this.filteredItems.length,...this.itemProvider.value),this.updateFilteredIndexMap(this.filteredItems.value.map((e,t)=>t)),this.isExpanded=!0}),this.onValueChange=(()=>{const{allowFreeform:e}=this.props,t=i.ObservableLike.getValue(this.props.text||"");return e&&(this.itemProvider.hasExtraItem&&this.filteredItems.pop(),this.itemProvider.setTextValue(t)),this.updateFilteredItems(),!1}),this.updateFilteredItems=(()=>{const e=this.itemProvider.value,t=i.ObservableLike.getValue(this.props.text||"");if(t){const{filteredItems:e,filteredIndexMap:s}=I.filterItems(this.itemProvider.value,i.ObservableLike.getValue(t||""),[],this.props.filterItem);this.filteredItems.splice(0,this.filteredItems.length,...e),this.updateFilteredIndexMap(s)}else this.filteredItems.splice(0,this.filteredItems.length,...e),this.updateFilteredIndexMap(this.filteredItems.value.map((e,t)=>t));return!1}),this.onKeyDown=(e=>{switch(e.which){case 27:this.collapse(),e.preventDefault();break;case 13:this.isExpanded||(this.expand(),e.preventDefault());case 9:this.isExpanded&&!e.shiftKey&&this.filteredItems.length&&(this.selectIndex(this.focusedIndex.value),this.collapse(),e.preventDefault());break;case 38:this.isExpanded&&(this.focusPreviousItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.indexOf(this.focusedIndex.value),{block:"nearest"})),e.preventDefault();break;case 40:this.isExpanded?(this.focusNextItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.indexOf(this.focusedIndex.value),{block:"nearest"})):this.isExpanded||this.expand(),e.preventDefault();break;case 46:case 8:i.ObservableLike.getValue(this.props.text||"")||(this.selection.clear(),this.props.onValueChange&&this.props.onValueChange());break;default:this.expand()}}),this.selection=e.selection||new d.DropdownSelection,this.itemProvider=new g.EditableDropdownItemProvider(e.items,this.selection),this.filteredItems=new i.ObservableArray([...this.itemProvider.value]),this.focusedIndex=new i.ObservableValue(-1),this.previousFocusedIndex=-1,this.filteredIndexMap=this.itemProvider.value.map((e,t)=>t)}render(){const{ariaLabel:e,calloutContentClassName:i,className:o,getUnselectableRanges:n,noItemsText:r,selectedText:a,text:d}=this.props;return s.createElement(t.Observer.Observer,{text:{observableValue:d,filter:this.onValueChange},items:{observableValue:this.props.items,filter:this.onItemsChange},selection:this.selection,selectedText:a},a=>{let d=this.props.placeholder;if(a.selectedText)d=a.selectedText;else if(a.selection.length){const e=a.selection[0].beginIndex;d=this.itemProvider.value[e].text}return s.createElement(I.Dropdown,{ariaLabel:e,calloutContentClassName:i,className:t.Util.css("bolt-editable-dropdown",(a.selection.length>0||!!a.selectedText)&&"bolt-editable-dropdown-with-selection",o),getUnselectableRanges:n,items:this.itemProvider,noItemsText:r||l.NoItemsFound,onCollapse:this.onCollapse,onExpand:this.onExpand,onSelect:this.onSelect,placeholder:d,ref:this.dropdown,renderCallout:this.renderCallout,renderExpandable:this.renderExpandable,renderItem:this.renderItem,selection:this.selection,showFilterBox:!1,userFilteredItems:this.filteredItems})})}focus(){this.dropdown.current&&this.dropdown.current.focus()}selectIndex(e){const{allowFreeform:t,onValueChange:s}=this.props;this.selection.select(e),!t&&s&&s(this.itemProvider.value[e]),this.selectedItemInList=!0}focusItem(e){void 0!==e&&e>-1&&(this.previousFocusedIndex=this.focusedIndex.value,this.focusedIndex.value=e)}updateFilteredIndexMap(e){const t=this.filteredIndexMap.indexOf(this.focusedIndex.value);this.filteredIndexMap=e;let s=e[t];(!s||s<0||!this.selection.selectable(s)||-1===this.filteredIndexMap.indexOf(s))&&(s=this.filteredIndexMap.find(e=>this.selection.selectable(e))),this.focusItem(s)}focusNextItem(){const e=this.filteredIndexMap.find(e=>e>this.focusedIndex.value&&this.selection.selectable(e));this.focusItem(e)}focusPreviousItem(){let e;for(let t=this.filteredIndexMap.indexOf(this.focusedIndex.value)-1;t>=0;t--)if(this.selection.selectable(this.filteredIndexMap[t])){e=this.filteredIndexMap[t];break}this.focusItem(e)}}o.defaultProps={renderExpandable:I.DropdownExpandableTextField,renderCallout:I.DropdownCallout,renderItem:p.renderListBoxCell},t.ComponentsEditableDropdownCustomEditableDropdown.CustomEditableDropdown=o}(),function(e){w=t.ComponentsEditableDropdownEditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsEditableDropdownEditableDropdown.EditableDropdown=class extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.collapse=(()=>{this.dropdown.current&&this.dropdown.current.collapse()}),this.expand=(()=>{this.dropdown.current&&this.dropdown.current.expand()}),this.onTextChange=((e,t)=>{this.props.onTextChange&&this.props.onTextChange(e,t),this.text.value=t}),this.onValueChange=(e=>{this.props.onValueChange&&this.props.onValueChange(e),this.selectedText.value=e&&e.text||""}),this.text=i.ObservableLike.isObservable(e.text)?e.text:new i.ObservableValue(e.text),this.selectedText=i.ObservableLike.isObservable(e.selectedText)?e.selectedText:new i.ObservableValue(e.selectedText)}focus(){this.dropdown.current&&this.dropdown.current.focus()}render(){return s.createElement(v.CustomEditableDropdown,Object.assign({},this.props,{onTextChange:this.onTextChange,onValueChange:this.onValueChange,ref:this.dropdown,selectedText:this.selectedText,text:this.text}))}}}(),t.EditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.EditableDropdown.EditableDropdown=w.EditableDropdown,t.EditableDropdown.CustomEditableDropdown=v.CustomEditableDropdown,function(e){t.UtilitiesGroupedItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesGroupedItemProvider.GroupedItemProvider=class{constructor(e,t,s){this.listItems=new i.ObservableArray,this.internalGroups=[...t],this.groupedItems=[[]];for(let e=0;e<this.internalGroups.length;e++)this.groupedItems.push([]);this.addItems(e);for(let e=0;e<this.internalGroups.length;e++)this.internalGroups[e].loading&&this.setGroupLoading(this.internalGroups[e].id,!0);s&&this.addHeaders(1,this.groups.length),this.manageHeaders=!!s}get groups(){return this.internalGroups}get length(){return this.listItems.length}get value(){return this.listItems.value}subscribe(e,t){this.listItems.subscribe(e,t)}unsubscribe(e,t){return this.listItems.unsubscribe(e,t)}push(...e){return this.addItems(e),e.length}pushGroups(...e){return this.addGroups(this.internalGroups.length,...e),this.internalGroups.length}pop(){const e=this.listItems.pop();return e&&this.removeItems([e]),e}removeAll(e){const t=this.listItems.removeAll(e);return this.removeItems(t,!1),t}splice(e,t,...s){const i=this.listItems.splice(e,t);return this.removeItems(i,!1),this.addItems(s),i}change(e,...t){const s=this.listItems.value.slice(e,t.length);return this.removeItems(s,!1),this.addItems(t,!1),this.listItems.change(e,...t),t.length}spliceGroups(e,t,...s){for(let s=0;s<t;s++){const t=e+s+1;if(this.groupedItems.length>t){if(this.removeItems([...this.groupedItems[t]]),this.manageHeaders){const e=this.groupedItems.findIndex(e=>e.length>0);e>0&&3===this.groupedItems[e][0].type&&this.removeItems([this.groupedItems[e][0]])}this.groupedItems.splice(t,1)}}const i=this.internalGroups.splice(e,t);return this.addGroups(e,...s),i}setGroupLoading(e,t,s){let i=this.groups.findIndex(t=>t.id===e);if(i<0)return;i++;const o=this.groupedItems[i];if(!t&&o.length&&4===o[o.length-1].type)this.removeItems([o[o.length-1]]);else if(t&&0===o.length||4!==o[o.length-1].type){const t=s||{id:e+"-loading",type:4,groupId:e};this.addItems([t])}this.groups[i-1].loading=t}addHeaders(e,t=1){for(let s=e;s<e+t;s++){let e=this.groups[s-1];if(this.groupedItems[s].length>0){this.groupedItems[s].find(e=>2===e.type)||this.addItems([{id:e.id+"-header",text:e.name||e.id,type:2,groupId:e.id}]),this.groupedItems.some((e,t)=>t<s&&e.length>0)&&!this.groupedItems[s].find(e=>3===e.type)&&this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]);const t=this.groupedItems.findIndex((e,t)=>t>s&&e.length>0);t>0&&!this.groupedItems[t].find(e=>3===e.type)&&(e=this.groups[t-1],this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]))}}}addGroups(e,...t){this.internalGroups.splice(e,0,...t);const s=[];for(let i=0;i<t.length;i++){this.groupedItems.splice(e+i+1,0,[]);for(let e=this.groupedItems[0].length-1;e>=0;e--)if(this.groupedItems[0][e].groupId===t[i].id){const t=this.groupedItems[0].splice(e,1)[0];this.listItems.splice(e,1),s.unshift(t)}}this.addItems(s),this.manageHeaders&&this.addHeaders(e+1,t.length);for(let e=0;e<t.length;e++)t[e].loading&&this.setGroupLoading(t[e].id,!0)}addItems(e,t=!0){for(let s=0;s<e.length;s++){let i=!1,o=0,n=0;const l=e[s].groupId;void 0!==l&&(o=this.internalGroups.findIndex(e=>e.id===l)+1);for(let e=0;e<o;e++)n+=this.groupedItems[e].length;3===e[s].type?this.groupedItems[o].unshift(e[s]):2===e[s].type?this.groupedItems[o].length&&3===this.groupedItems[o][0].type?(this.groupedItems[o].splice(1,0,e[s]),n++):this.groupedItems[o].unshift(e[s]):(n+=this.groupedItems[o].length,this.groupedItems[o].push(e[s]),i=o>0&&1===this.groupedItems[o].length&&this.manageHeaders),t&&this.listItems.splice(n,0,e[s]),i&&this.addHeaders(o)}}removeItems(e,t=!0){for(let s=0;s<e.length;s++){let i=0,o=0;const n=e[s].groupId;void 0!==n&&(i=this.internalGroups.findIndex(e=>e.id===n)+1);for(let e=0;e<i;e++)o+=this.groupedItems[e].length;const l=this.groupedItems[i],r=l.indexOf(e[s]);l.splice(r,1),t&&this.listItems.splice(o+r,1)}}}}(),function(e){t.UtilitiesPivotItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesPivotItemProvider.PivotItemProvider=class{constructor(e){this.listItems=new i.ObservableArray,this.internalPivots=e;for(let t=0;t<e.length;t++)this.listItems.push(...i.ObservableLike.getValue(e[t].items))}get pivots(){return this.internalPivots}get length(){return this.listItems.length}get value(){return this.listItems.value}subscribe(e,t){this.listItems.subscribe(e,t)}unsubscribe(e,t){return this.listItems.unsubscribe(e,t)}push(e,...t){let s=0;for(let i=0;i<this.pivots.length;i++)if(s+=this.pivots[i].items.length,this.pivots[i].id===e){this.pivots[i].items.push(...t),this.listItems.splice(s,0,...t);break}return this.length}pop(e){let t=0;for(let s=0;s<this.pivots.length;s++)if(t+=this.pivots[s].items.length,this.pivots[s].id===e)return this.pivots[s].items.pop(),this.listItems.splice(t-1,1)[0]}removeAll(e,t){let s=0;const o=[];for(let n=0;n<this.pivots.length;n++){if(this.pivots[n].id===e){const e=[...i.ObservableLike.getValue(this.pivots[n].items)];for(let i=0;i<e.length;i++)if(!t||t(e[i])){const e=this.pivots[n].items.splice(i,1);o.push(...e),this.listItems.splice(s+i,1)}break}s+=this.pivots[n].items.length}return o}splice(e,t,s,...i){let o=0;for(let n=0;n<this.pivots.length;n++){if(this.pivots[n].id===e){const e=this.pivots[n].items.splice(t,s,...i);return this.listItems.splice(o+t,s,...i),e}o+=this.pivots[n].items.length}return[]}}}()},["Resources.Dropdown","Components/ExpandableTextField/ExpandableTextField","ExpandableTextField","Utilities/DropdownSelection","Components/ListBox/ListBox","ListBox","Components/Dropdown/DropdownCallout","Components/Dropdown/DropdownExpandableTextField","Components/Dropdown/Dropdown","Components/Dropdown/DropdownExpandableButton","Components/Dropdown/DropdownFilterBarItem","Components/Dropdown/WithPivots","Dropdown","Utilities/EditableDropdownItemProvider","Components/EditableDropdown/CustomEditableDropdown","Components/EditableDropdown/EditableDropdown","EditableDropdown","Utilities/GroupedItemProvider","Utilities/PivotItemProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-dropdown-content"}}));